# =============================================================================
# ğŸ’¾ MySQL PersistentVolumeClaim
# =============================================================================
# ğŸ“ ì„¤ëª…: MySQL ë°ì´í„° ì˜ì†ì„±ì„ ìœ„í•œ ë³¼ë¥¨ ìš”ì²­ ì •ì˜
# ğŸ¯ ëª©ì : MySQL ë°ì´í„°ê°€ Pod ì¬ì‹œì‘/ì´ë™ ì‹œì—ë„ ìœ ì§€ë˜ë„ë¡ ë³´ì¥
# ğŸŒŸ ì‹¤ë¬´ íŒ: ë¡œì»¬ ê°œë°œì—ì„œëŠ” HostPath, ìš´ì˜ì—ì„œëŠ” SSD StorageClass ì‚¬ìš©
# ğŸ”„ ì‹¤í–‰ ìˆœì„œ: #4-1-1 (ë°ì´í„°ë² ì´ìŠ¤ ë°°í¬ ì „ ì‹¤í–‰)
# ğŸ“– ì°¸ê³ : https://kubernetes.io/docs/concepts/storage/persistent-volumes/
# =============================================================================

apiVersion: v1
kind: PersistentVolumeClaim

metadata:
  name: mysql-pvc                # PVC ì´ë¦„ (ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ë‚´ ê³ ìœ )
  namespace: web3-community     # ì†Œì† ë„¤ì„ìŠ¤í˜ì´ìŠ¤
  
  labels:
    app: web3-community
    component: database
    database: mysql
    tier: data
    environment: local
  
  annotations:
    description: "Persistent storage for MySQL database"
    storage-class: "standard"
    created-by: "developer"

spec:
  # =============================================================================
  # ğŸ’¾ ìŠ¤í† ë¦¬ì§€ ì ‘ê·¼ ëª¨ë“œ
  # =============================================================================
  # ReadWriteOnce: ë‹¨ì¼ ë…¸ë“œì—ì„œ ì½ê¸°/ì“°ê¸° ê°€ëŠ¥ (ë¡œì»¬ ê°œë°œì— ì í•©)
  # ReadWriteMany: ì—¬ëŸ¬ ë…¸ë“œì—ì„œ ë™ì‹œ ì ‘ê·¼ ê°€ëŠ¥ (ê³µìœ  ìŠ¤í† ë¦¬ì§€)
  accessModes:
    - ReadWriteOnce
  
  # =============================================================================
  # ğŸ—ï¸ ìŠ¤í† ë¦¬ì§€ í´ë˜ìŠ¤
  # =============================================================================
  # Minikube/Docker Desktopì˜ ê¸°ë³¸ StorageClass
  # ìš´ì˜ í™˜ê²½ì—ì„œëŠ” ssd, hdd, gp2 ë“± ì„±ëŠ¥ë³„ í´ë˜ìŠ¤ ì‚¬ìš©
  storageClassName: "standard"
  
  # =============================================================================
  # ğŸ“Š ìŠ¤í† ë¦¬ì§€ ìš©ëŸ‰
  # =============================================================================
  resources:
    requests:
      storage: 10Gi              # 10GB ìŠ¤í† ë¦¬ì§€ ìš”ì²­ (ë¡œì»¬ ê°œë°œìš©)
      # ìš´ì˜ í™˜ê²½: 100Gi~500Gi ê¶Œì¥

# =============================================================================
# ğŸŒŸ ì‹¤ë¬´ íŒ ë° ì¶”ê°€ ì„¤ì •
# =============================================================================
# 
# ìš´ì˜ í™˜ê²½ì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì¶”ê°€ ì„¤ì • ê³ ë ¤:
# - high-performance ìŠ¤í† ë¦¬ì§€ í´ë˜ìŠ¤ (SSD, NVMe)
# - backup ë° snapshot ì •ì±…
# - ë³µì œë³¸ì„ ìœ„í•œ ë‹¤ì¤‘ PVC
# - ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ë° ê²½ê³  ì„¤ì •
#
# PVC ìƒíƒœ í™•ì¸:
# kubectl get pvc mysql-pvc -n web3-community
# kubectl describe pvc mysql-pvc -n web3-community
#
# PVC í¬ê¸° ì¡°ì • (Kubernetes 1.11+):
# kubectl patch pvc mysql-pvc -n web3-community -p '{"spec":{"resources":{"requests":{"storage":"20Gi"}}}}'
#
# PVC ì‚­ì œ (ë°ì´í„° ëª¨ë‘ ì‚­ì œ! ì£¼ì˜!):
# kubectl delete pvc mysql-pvc -n web3-community
# =============================================================================