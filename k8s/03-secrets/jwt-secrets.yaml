# =============================================================================
# ğŸ”’ JWT ë° ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œí¬ë¦¿
# =============================================================================
# ğŸ“ ì„¤ëª…: JWT í† í°, OAuth2, API í‚¤ ë“± ì• í”Œë¦¬ì¼€ì´ì…˜ ë ˆë²¨ì˜ ë¯¼ê° ì •ë³´ ì €ì¥
# ğŸ¯ ëª©ì : ì¸ì¦/ì¸ê°€ ê´€ë ¨ ë³´ì•ˆ ì •ë³´ ì¤‘ì•™ ê´€ë¦¬, í‚¤ ë¡œí…Œì´ì…˜ ì§€ì›
# âš ï¸  ì£¼ì˜ì‚¬í•­: Git ì»¤ë°‹ ê¸ˆì§€, ì •ê¸°ì ì¸ í‚¤ ë¡œí…Œì´ì…˜ í•„ìˆ˜
# ğŸŒŸ ì‹¤ë¬´ íŒ: ê° ì„œë¹„ìŠ¤ë³„ Secret ë¶„ë¦¬ ê´€ë¦¬ë¡œ ë³´ì•ˆ ì˜í–¥ë„ ìµœì†Œí™”
# ğŸ”„ ì‹¤í–‰ ìˆœì„œ: #3-2 (ë„¤ì„ìŠ¤í˜ì´ìŠ¤, ConfigMap, DB Secrets ìƒì„± í›„ ì‹¤í–‰)
# ğŸ”„ ì£¼ê¸°: ë³´ì•ˆ ì •ì±…ì— ë”°ë¼ ì •ê¸°ì  ë¡œí…Œì´ì…˜ (30-90ì¼ ê¶Œì¥)
# ğŸ“– ì°¸ê³ : https://kubernetes.io/docs/concepts/configuration/secret/
# =============================================================================

apiVersion: v1
kind: Secret

metadata:
  name: jwt-secrets
  namespace: web3-community
  
  labels:
    app: web3-community
    component: authentication
    secret-type: jwt-tokens
    tier: security
    environment: local
  
  annotations:
    description: "JWT and authentication secrets for web3-community"
    created-by: "developer"
    rotation-policy: "90-days"
    last-rotated: "2024-02-03"
    next-rotation: "2024-05-03"
    security-level: "high"

type: Opaque

data:
  # =============================================================================
  # ğŸ” JWT Access Token ì‹œí¬ë¦¿
  # =============================================================================
  # Access Token ì„œëª…ìš© ì‹œí¬ë¦¿ í‚¤ (ìµœì†Œ 256 bits ê¶Œì¥)
  jwt-access-secret: "bXlzZWNyZXRqd2RrZXkxMjM0NTY3ODkwMTIzNDU2Nzg5MDEyMzQ1Njc4OTA="  # base64: 'mysecretjwdkey123456789012345678901234567890'
  
  # Access Token ë§Œë£Œ ì‹œê°„ (ì´ˆ ë‹¨ìœ„)
  jwt-access-expiration: "ODY0MDA="              # base64: '86400' (24ì‹œê°„)
  
  # Access Token ë¦¬í”„ë ˆì‹œ ì‹œê°„ (ì´ˆ ë‹¨ìœ„)
  jwt-access-refresh: "NDzMjA="                   # base64: '43200' (12ì‹œê°„)

  # =============================================================================
  # ğŸ”„ JWT Refresh Token ì‹œí¬ë¦¿
  # =============================================================================
  # Refresh Token ì„œëª…ìš© ì‹œí¬ë¦¿ í‚¤
  jwt-refresh-secret: "bXlyZWZyZXNoa2V5MTIzNDU2Nzg5MDEyMzQ1Njc4OTAxMjM0NTY3ODkw"  # base64: 'myrefreshkey123456789012345678901234567890'
  
  # Refresh Token ë§Œë£Œ ì‹œê°„ (ì´ˆ ë‹¨ìœ„)
  jwt-refresh-expiration: "NjA0ODAw="             # base64: '604800' (7ì¼)
  
  # Refresh Token ì‚¬ìš© ìµœëŒ€ íšŸìˆ˜
  jwt-refresh-max-uses: "MTA="                   # base64: '10'

  # =============================================================================
  # ğŸ“± JWT Mobile Token ì‹œí¬ë¦¿ (ëª¨ë°”ì¼ ì•±ìš©)
  # =============================================================================
  # Mobile Access Token ì‹œí¬ë¦¿
  jwt-mobile-access-secret: "bW9iaWxlandrZXkxMjM0NTY3ODkwMTIzNDU2Nzg5MDEyMzQ1Njc4OTA="  # base64: 'mobilejwkey123456789012345678901234567890'
  
  # Mobile Token ë§Œë£Œ ì‹œê°„ (ëª¨ë°”ì¼ì€ ë” ì§§ê²Œ)
  jwt-mobile-expiration: "MTI5NjAw="               # base64: '129600' (36ì‹œê°„)

  # =============================================================================
  # ğŸŒ OAuth2 Provider ì‹œí¬ë¦¿
  # =============================================================================
  # Google OAuth2 í´ë¼ì´ì–¸íŠ¸ ì‹œí¬ë¦¿
  google-client-secret: "Z29vZ2xlLWNsaWVudC1zZWNyZXQtMTIzNDU2Nzg5MA=="                # base64: 'google-client-secret-1234567890'
  
  # GitHub OAuth2 í´ë¼ì´ì–¸íŠ¸ ì‹œí¬ë¦¿
  github-client-secret: "Z2l0aHViLWNsaWVudC1zZWNyZXQtMTIzNDU2Nzg5MA=="                # base64: 'github-client-secret-1234567890'
  
  # Naver OAuth2 í´ë¼ì´ì–¸íŠ¸ ì‹œí¬ë¦¿
  naver-client-secret: "bmF2ZXItY2xpZW50LXNlY3JldC0xMjM0NTY3ODkw"                    # base64: 'naver-client-secret-1234567890'
  
  # Kakao OAuth2 í´ë¼ì´ì–¸íŠ¸ ì‹œí¬ë¦¿
  kakao-client-secret: "a2FrYW8tY2xpZW50LXNlY3JldC0xMjM0NTY3ODkw"                    # base64: 'kakao-client-secret-1234567890'

  # =============================================================================
  # ğŸ”‘ API Key ì‹œí¬ë¦¿
  # =============================================================================
  # ì™¸ë¶€ API í˜¸ì¶œìš© ì‹œí¬ë¦¿ í‚¤
  external-api-key: "ZXh0ZXJuYWwtYXBpLWtleS0xMjM0NTY3ODkwMTIzNDU2Nzg5MA=="          # base64: 'external-api-key-12345678901234567890'
  
  # ì„œë¹„ìŠ¤ ê°„ í†µì‹ ìš© API í‚¤
  internal-service-key: "aW50ZXJuYWwtc2VydmljZS1rZXktMTIzNDU2Nzg5MDEyMzQ1Njc4OTA="    # base64: 'internal-service-key-12345678901234567890'
  
  # ì›¹í›… ì‹œê·¸ë‹ˆì²˜ ê²€ì¦ìš© ì‹œí¬ë¦¿
  webhook-signature-secret: "d2ViaG9vay1zaWduYXR1cmUtc2VjcmV0LTEyMzQ1Njc4OTA="       # base64: 'webhook-signature-secret-1234567890'

  # =============================================================================
  # ğŸ” ì•”í˜¸í™” ì‹œí¬ë¦¿
  # =============================================================================
  # ë°ì´í„° ì•”í˜¸í™”ìš© ëŒ€ì¹­í‚¤ (AES-256)
  encryption-key: "ZW5jcnlwdGlvbi1rZXktMTIzNDU2Nzg5MDEyMzQ1Njc4OTAxMjM0NTY3ODkw"      # base64: 'encryption-key-123456789012345678901234567890'
  
  # ë¹„ë°€ë²ˆí˜¸ í•´ì‹±ìš© ì†”íŠ¸
  password-salt: "cGFzc3dvcmQtc2FsdC0xMjM0NTY3ODkwMTIzNDU2Nzg5MA=="                    # base64: 'password-salt-12345678901234567890'
  
  # ì´ë©”ì¼ ì¸ì¦ í† í° ì‹œí¬ë¦¿
  email-verification-secret: "ZW1haWwtdmVyaWZpY2F0aW9uLXNlY3JldC0xMjM0NTY3ODkw"        # base64: 'email-verification-secret-1234567890'
  
  # ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • í† í° ì‹œí¬ë¦¿
  password-reset-secret: "cGFzc3dvcmQtcmVzZXQtc2VjcmV0LTEyMzQ1Njc4OTA="               # base64: 'password-reset-secret-1234567890'

  # =============================================================================
# ğŸ” ì„¤ëª… ë° ì‚¬ìš©ë²•
# =============================================================================
# 
# ì´ Secret ì‚¬ìš© ë°©ë²•:
# 1. Auth Service í™˜ê²½ ë³€ìˆ˜ë¡œ ì£¼ì…:
#    env:
#      - name: JWT_ACCESS_SECRET
#        valueFrom:
#          secretKeyRef:
#            name: jwt-secrets
#            key: jwt-access-secret
#      - name: JWT_ACCESS_EXPIRATION
#        valueFrom:
#          secretKeyRef:
#            name: jwt-secrets
#            key: jwt-access-expiration
#
# 2. ì—¬ëŸ¬ ì„œë¹„ìŠ¤ì—ì„œ ê³µí†µìœ¼ë¡œ ì‚¬ìš©:
#    envFrom:
#      - secretRef:
#          name: jwt-secrets
#
# 3. Init Containerì—ì„œ í† í° ê²€ì¦:
#    initContainers:
#      - name: validate-jwt
#        image: busybox
#        command: ['sh', '-c']
#        args:
#          - |
#            echo "JWT secrets loaded successfully"
#            echo "Access secret length: $(echo $JWT_ACCESS_SECRET | wc -c)"
#            echo "Refresh secret length: $(echo $JWT_REFRESH_SECRET | wc -c)"
#
# ë³´ì•ˆ ëª¨ë²” ì‚¬ë¡€:
# 1. ìµœì†Œ ê¶Œí•œ ì›ì¹™: í•„ìš”í•œ ì„œë¹„ìŠ¤ë§Œ ì ‘ê·¼ ê¶Œí•œ ë¶€ì—¬
# 2. ì£¼ê¸°ì  ë¡œí…Œì´ì…˜: 30-90ì¼ ì£¼ê¸°ë¡œ í‚¤ ë³€ê²½
# 3. ê°•ë ¥í•œ í‚¤ ìƒì„±: ì¶©ë¶„í•œ ì—”íŠ¸ë¡œí”¼ë¡œ ëœë¤ í‚¤ ìƒì„±
# 4. í™˜ê²½ ë¶„ë¦¬: dev/staging/prodë³„ ë‹¤ë¥¸ í‚¤ ì‚¬ìš©
# 5. ì ‘ê·¼ ë¡œê¹…: Secret ì ‘ê·¼ ì´ë ¥ ê¸°ë¡ ë° ê°ì‹œ
#
# í‚¤ ë¡œí…Œì´ì…˜ ìŠ¤í¬ë¦½íŠ¸:
# ```bash
# #!/bin/bash
# # JWT Access Token ì‹œí¬ë¦¿ ë¡œí…Œì´ì…˜
# NEW_ACCESS_SECRET=$(openssl rand -base64 64)
# 
# # Secret ì—…ë°ì´íŠ¸
# kubectl patch secret jwt-secrets \
#   -n web3-community \
#   -p '{"data":{"jwt-access-secret":"'$(echo -n $NEW_ACCESS_SECRET | base64)'"}}'
# 
# # ê´€ë ¨ ì„œë¹„ìŠ¤ ì¬ì‹œì‘
# kubectl rollout restart deployment/auth-service -n web3-community
# kubectl rollout restart deployment/api-gateway -n web3-community
# 
# echo "JWT secrets rotated successfully!"
# ```
#
# ì‹¤ë¬´ íŒ:
# - ê° í™˜ê²½ë³„ë¡œ ë‹¤ë¥¸ Secret ì‚¬ìš© (ë¬´ë‹¨ ë³µì œ ë°©ì§€)
# - Secret ë²„ì „ ê´€ë¦¬ (jwt-secrets-v1, v2 ë“±)
# - ìë™í™”ëœ í‚¤ ë¡œí…Œì´ì…˜ íŒŒì´í”„ë¼ì¸ êµ¬ì¶•
# - Secret ì ‘ê·¼ ì œì–´ (RBAC) ì„¤ì •
# - ê°ì‚¬ ë¡œê·¸ ë° ì•Œë¦¼ ì‹œìŠ¤í…œ ì—°ë™
# =============================================================================